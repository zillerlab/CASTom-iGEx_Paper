####################
#### predict GE ####

perc_all=(50 70 90)

for perc in ${perc_all[@]}
do
sbatch --job-name=UKBB_AA_${perc} --array=1-100%10 PriLer_predExpr_200kb_UKBB_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_HLV_${perc} --array=1-100%10 PriLer_predExpr_200kb_UKBB_downsampl.sh Heart_Left_Ventricle ${perc}
done

for perc in ${perc_all[@]}
do
sbatch --job-name=UKBB_AA_${perc} Combine_filteredGeneExpr_GTEx_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_HLV_${perc} Combine_filteredGeneExpr_GTEx_downsampl.sh Heart_Left_Ventricle ${perc}
done

##########################
#### compute T-scores ####

for perc in ${perc_all[@]}
do
sbatch --job-name=UKBB_AA_${perc} --array=1-100%10 Tscore_GTEx_splitGenes_UKBB_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_HLV_${perc} --array=1-100%10 Tscore_GTEx_splitGenes_UKBB_downsampl.sh Heart_Left_Ventricle ${perc}
done

#################################
#### compute pathway-scores #####

for perc in ${perc_all[@]}
do
sbatch --job-name=UKBB_AA_${perc} PathScore_GTEx_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_HLV_${perc} PathScore_GTEx_downsampl.sh Heart_Left_Ventricle ${perc}
done

for perc in ${perc_all[@]}
do
sbatch --job-name=UKBB_AA_${perc} PathScore_wikiPath_GTEx_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_HLV_${perc} PathScore_wikiPath_GTEx_downsampl.sh Heart_Left_Ventricle ${perc}
done

######################################
#### associate with CAD phenotype ####

# prepare
for perc in ${perc_all[@]}
do
sbatch --job-name=UKBB_AA_${perc} PriLer_phenoAssociation_GTEx_prepare_CAD_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_HLV_${perc} PriLer_phenoAssociation_GTEx_prepare_CAD_downsampl.sh Heart_Left_Ventricle ${perc}
done

for perc in ${perc_all[@]}
do
sbatch --job-name=UKBB_AA_${perc} PriLer_phenoAssociation_GTEx_prepare_wikiPath_CAD_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_HLV_${perc} PriLer_phenoAssociation_GTEx_prepare_wikiPath_CAD_downsampl.sh Heart_Left_Ventricle ${perc}
done

# associate genes, pathways, custom pathways
for perc in ${perc_all[@]}
do

sbatch --job-name=UKBB_AA_${perc} --array=1-100%30 PriLer_phenoAssociation_GTEx_tscore_CAD_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_AA_${perc} --array=1-100%30 PriLer_phenoAssociation_GTEx_pathR_CAD_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_AA_${perc} --array=1-100%30 PriLer_phenoAssociation_GTEx_pathGO_CAD_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_AA_${perc} PriLer_phenoAssociation_GTEx_wikiPath_CAD_downsampl.sh Artery_Aorta ${perc}

sbatch --job-name=UKBB_HLV_${perc} --array=1-100%30 PriLer_phenoAssociation_GTEx_tscore_CAD_downsampl.sh Heart_Left_Ventricle ${perc}
sbatch --job-name=UKBB_HLV_${perc} --array=1-100%30 PriLer_phenoAssociation_GTEx_pathR_CAD_downsampl.sh Heart_Left_Ventricle ${perc}
sbatch --job-name=UKBB_HLV_${perc} --array=1-100%30 PriLer_phenoAssociation_GTEx_pathGO_CAD_downsampl.sh Heart_Left_Ventricle ${perc}
sbatch --job-name=UKBB_HLV_${perc} PriLer_phenoAssociation_GTEx_wikiPath_CAD_downsampl.sh Heart_Left_Ventricle ${perc}

done

# combine results
for perc in ${perc_all[@]}
do
sbatch --job-name=UKBB_AA_${perc} PriLer_phenoAssociation_GTEx_combine_CAD_downsampl.sh Artery_Aorta ${perc}
sbatch --job-name=UKBB_AA_${perc} PriLer_phenoAssociation_GTEx_combine_wikiPath_CAD_downsampl.sh Artery_Aorta ${perc}

sbatch --job-name=UKBB_HLV_${perc} PriLer_phenoAssociation_GTEx_combine_CAD_downsampl.sh Heart_Left_Ventricle ${perc}
sbatch --job-name=UKBB_HLV_${perc} PriLer_phenoAssociation_GTEx_combine_wikiPath_CAD_downsampl.sh Heart_Left_Ventricle ${perc}
done
